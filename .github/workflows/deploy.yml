name: CI/CD with Docker Compose (Local)

on:
  push:
    branches:
      - main
    paths:
      - "frontend/**"
      - "backend/**"
      - "docker_compose.yml"

jobs:
  build-and-run:
    runs-on: ubuntu-latest

    steps:
      - name:  Checkout code
        uses: actions/checkout@v3

      - name:  Set up Docker Buildx
        uses: docker/setup-buildx-action@v2

      - name:  Check Docker version
        run: docker version

      - name:  Check docker-compose.yml exists
        run: ls -lah | grep docker_compose.yml || echo "‚ùå docker_compose.yml not found"

      - name: üõ† Build Docker images
        run: docker-compose -f docker_compose.yml build

      - name:  Run Docker containers
        run: docker-compose -f docker_compose.yml up -d

      - name:  Check running containers
        run: docker ps -a
